# 上课监控
## 需求背景
为了有效地把控中外教老师的上课质量, 提升学生的上课体验, 开发此app.
###使用人
此app仅供公司内部运营人员使用, 
### 使用方法
用户能够通过特定账号登录app, 查看为其分配的需要监控的课程. 在线监控上课期间, 用户可随意进出房间, 退出房间以后, 需填写监控反馈.



### 和学生版账号的区别

1. 上课监控账号能够登录学生版app, 学生账号无法登录上课监控app.
2. 上课监控账号监控小班课和一对一课程时, 和学生一样能够接收房间里音视频流以及消息, 但是不能被老师点到, 不会和老师进行交互.
3. 上课监控人员结束课程监控时, 会对老师和课程整体做出详细评价.

## 上课监控页面
### 登录页面

![](https://raw.githubusercontent.com/mountainKingG/classMonitor/master/%E4%B8%8A%E8%AF%BE%E7%9B%91%E6%8E%A7%E7%99%BB%E5%BD%95%E9%A1%B5%E9%9D%A2.png)

说明:

* 没有注册功能, 使用盒子鱼学生版注册账号, 后台相关人员把这些账号的 userId 添加到上课监控超级用户列表, 并根据后台返回的超级用户列表数据存储相应的 userType.
  1. 内容研发的 userType: content
  2. 外教运营的 userType: student
  
* 超级用户: 能够登录盒子鱼学生版和上课监控app的用户, 分配给此用户的在线授课课程, 可以在上课时段内随意进出, 在线授课的学生和老师不受干扰.

```
网络请求类: CMTHTTPServer
请求超级用户列表:
- (void)getSuperUserList {
    NSString *urlString = [NSString stringWithFormat:@"%@/class/monitor/super/user",
    [[ServerManager sharedInstance] getTeachCenterBaseUrl]];
    
    [self get:urlString requestType:BFERequestTypeJSON 
    parameters:nil loadingOnTheView:nil loadingTitle:nil needAccessToken:YES];
}
```

* 登录上课监控的账号, 进入主页面后, 会使用上述列表返回的用户进行过滤, 如果非超级用户, 就返回登录页面.

```
所属类:CMTTabBarController
- (void)checkWhetherSuperUser {
    NSNumber *userId = [CommonInfoPersistenceManager getSavedUserId];
    BOOL ret = NO;
    for (CMTSuperUserModel *userModel in _superUsersArray) {
        if ([userId isEqualToNumber:userModel.userId]) {
            NSString *userType = [NSString stringWithFormat:@"%@",userModel.userType];
            [CommonGlobal sharedInstance].userType = userType;
            ret = YES;
        }
    }
    if (ret == NO) {
        [self showLoginViewController];
    }
}
```

### 小班课页面

![](https://raw.githubusercontent.com/mountainKingG/classMonitor/master/%E5%88%86%E6%97%B6%E6%AE%B5%E5%88%86%E9%85%8D%E8%AF%BE%E7%A8%8B%E9%A1%B5%E9%9D%A2%E5%B0%8F%E7%8F%AD%E8%AF%BE.png)

* 目前上课监控只监控小班课和外教一对一, 用户登录成功以后, 首先看到的是分配给用户的时间段和课程数列表, 点击进去显示此时间段的课程列表.
* 主要包含四个信息:

	1. 头部标题: 时间是请求服务器时间返回的北京时间
	2. 时间段: 是所监控课程的上课时间段
	3. 课程数: 所在时间段分配的课程数
	4. 未评价: 显示的是未评价的课程数

```
所属类:CMTSmallClassTableViewController
方法: 请求时间段课程数列表
[_httpServer getCourseCountListWithClassType:@"SMALL"
                                           startTime:_startTime
                                             endTime:_endTime
                                                Size:kPageSize
                                                Page:_page
                                              userId:studentId];
```

### 外教一对一页面
![](https://raw.githubusercontent.com/mountainKingG/classMonitor/master/%E5%88%86%E6%97%B6%E6%AE%B5%E5%88%86%E9%85%8D%E8%AF%BE%E7%A8%8B%E9%A1%B5%E9%9D%A2%E4%B8%80%E5%AF%B9%E4%B8%80.png)

* 点击进去显示此时间段的外教一对一的课程列表.
* 主要包含四个信息:

	1. 头部标题: 时间是请求服务器时间返回的北京时间
	2. 时间段: 是所监控课程的上课时间段
	3. 课程数: 所在时间段分配的课程数
	4. 未评价: 显示的是未评价的课程数

```
所属类:CMTForeignerOneTableViewController
方法: 请求时间段课程数列表
if (self.onlineCourseType == CMTOnlineCourseTypeOneToOne) {
        [_httpServer getCourseCountListWithClassType:@"NORMAL"
                                           startTime:_startTime
                                             endTime:_endTime
                                                Size:kPageSize
                                                Page:_page
                                              userId:studentId];
    }
```

### 外教大讲堂
![](https://raw.githubusercontent.com/mountainKingG/classMonitor/master/%E5%A4%96%E6%95%99%E5%A4%A7%E8%AE%B2%E5%A0%82.png)

* 外教大讲堂监控功能还未加入

### 课程列表页面
![](https://raw.githubusercontent.com/mountainKingG/classMonitor/master/%E8%AF%BE%E7%A8%8B%E5%88%97%E8%A1%A8%E9%A1%B5%E9%9D%A2.png)

* 点击进去显示此时间段的外教一对一的课程列表.
* 主要包含四个信息:

	1. 头部标题: 时间是请求服务器时间返回的北京时间
	2. 时间段: 是所监控课程的上课时间段
	3. 课程数: 所在时间段分配的课程数
	4. 未评价: 显示的是未评价的课程数

```
所属类:CMTForeignerOneTableViewController
方法: 请求时间段课程数列表
if (self.onlineCourseType == CMTOnlineCourseTypeOneToOne) {
        [_httpServer getCourseCountListWithClassType:@"NORMAL"
                                           startTime:_startTime
                                             endTime:_endTime
                                                Size:kPageSize
                                                Page:_page
                                              userId:studentId];
    }
```
